{% extends 'base.html' %}
{% block head %}

  <link href="/static/results.css" rel="stylesheet">
  <script src="http://code.jquery.com/jquery.js"></script>
  <script src="/static/savejob.js"></script>
  <script src="/static/companymap.js"></script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key={{ gmaps }}&callback=initMap">
  </script>
{% endblock %}

{% block body %}
<form action="/results/1">
<div class="row">
  Title: <input type="text" name="title">
</div>
<div class="row">
  Filter: <select name="station">
    <option value="all">all stations</option>   
    {% for station in stations %}
      <option value={{ station[0] }}>{{ station[1] }}</option>
    {% endfor %}
  </select>

  <select name="days">
    <option value="999">anytime</option>
    <option value="1">since yesterday</option>
    <option value="3">within 3 days</option>
    <option value="7">within 7 days</option>
    <option value="15">within 15 days</option>
    <option value="30">within 30 days</option>
  </select>

  <select name="display">
    <option value="10">10 per page</option>
    <option value="25">25 per page</option>
    <option value="50">50 per page</option>
    <option value="100">100 per page</option>
  </select>

  </div>
  <input type="submit">

</form>
<button id="reset-map">Reset Map
<div id="companymap"></div>

  {% if current_page_results %}
    {% for job in current_page_results %}
      <div class="media">
        <img class="pull-left" src="{{ job[8] }}">
        <div class="media-body">
        <a href="{{ job[0] }}">{{ job[1] }}</a></h5><br>
        {{ job[2] }}<br>
        Posted: {{ job[3] }} - {{ job [4] }}<br>
        BART Station: {{ job [5] }} | Distance: {{ job[6] }} | Walking Time: ~{{ job[7] }}<br>
        Glassdoor Rating: <a href="{{ job[11] }}">{{ job[9] }}</a> | Industry: {{ job[10] }}<br>

          {% if 'user_id' in session %}
            {% if job[12] in saved_jobs %}
          <button name="save-job" id="{{ job[12] }}" class="saved">Save</button>
              {% else %}
          <button name="save-job" id="{{ job[12] }}" class="not-saved">Save</button>
            {% endif %}

          {% endif %}
        </div>  
      </div>
    {% endfor %}
  {% else %}
    <h4>No Results</h4>

  {% endif %}

    {% if num_pages > 1 %}

    <nav aria-label="pagenav">
      <ul class="pagination">

        {% for page in range(1, num_pages + 1) %}

          {% if page == page_num %}
            <li class="page-item active" id="current_page" value="{{ page }}">
          {% else %}
            <li class="page-item">
          {% endif %}

          <a class="page-link" href="/results/{{ page }}?title={{ title }}&station={{ selected_station }}&days={{ days }}&display={{ display_per_page }}">{{ page }}</a>
            </li>

        {% endfor %}
      </ul>
    </nav>

  {% endif %}

{% endblock %}